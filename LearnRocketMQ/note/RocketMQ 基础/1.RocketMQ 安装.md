# 1.Linux 安装







# 2.Docker 安装

> 由于 RocketMQ 需要有`broker`组件和`nameserver`组件，即有多个 docker 容器，因此使用 docker-compose 编排容器将更加方便。

## 2.1 docker-compose.yml

下面是根据官方仓库修改后的 `docker-compose.yml` 文件，增加了 `rocketmq-console-ng` 控制台项目，方便操作和观察。

```
version: '3.5'
services:
  #Service for nameserver
  namesrv:
    image: apacherocketmq/rocketmq:4.5.0
    container_name: rmqnamesrv
    ports:
      - 9876:9876
    volumes:
      - ./data/namesrv/logs:/home/rocketmq/logs
    command: sh mqnamesrv
    networks:
      - rmq

  #Service for broker
  broker:
    image: apacherocketmq/rocketmq:4.5.0
    container_name: rmqbroker
    links:
      - namesrv
    ports:
      - 10909:10909
      - 10911:10911
      - 10912:10912
    environment:
      - NAMESRV_ADDR=namesrv:9876
    volumes:
      - ./data/broker/logs:/home/rocketmq/logs
      - ./data/broker/store:/home/rocketmq/store
      - ./data/broker/conf/broker.conf:/opt/rocketmq-4.5.0/conf/broker.conf
    command: sh mqbroker -c /opt/rocketmq-4.5.0/conf/broker.conf
    networks:
      - rmq

  rmqconsole:
    image: styletang/rocketmq-console-ng
    container_name: rmqconsole
    ports:
      - 8080:8080
    environment:
      JAVA_OPTS: "-Drocketmq.namesrv.addr=namesrv:9876 -Dcom.rocketmq.sendMessageWithVIPChannel=false"
    depends_on:
      - namesrv
    networks:
      - rmq

networks:
  rmq:
    name: rmq
    driver: bridge
```

> 具体配置文件等参看链接：https://github.com/lujiahao0708/LearnSeries/tree/master/LearnDocker/RocketMQ

## 2.2 启动

`docker-compose.yml`和配置文件下载好后，启动 docker-compose 即可

```
~ docker-compose up -d
Creating rmqnamesrv ... done
Creating rmqbroker  ... done
Creating rmqconsole ... done
```

## 2.3 查看

使用 `docker ps` 查看运行中的容器

```
~ docker ps
CONTAINER ID        IMAGE                           COMMAND                  CREATED             STATUS              PORTS                                                                      NAMES
169845d28ac8        apacherocketmq/rocketmq:4.5.0   "sh mqbroker -c /opt…"   40 minutes ago      Up 40 minutes       0.0.0.0:10909->10909/tcp, 9876/tcp, 0.0.0.0:10911-10912->10911-10912/tcp   rmqbroker
e4a4f2a1cade        styletang/rocketmq-console-ng   "sh -c 'java $JAVA_O…"   40 minutes ago      Up 40 minutes       0.0.0.0:8080->8080/tcp                                                     rmqconsole
ec90128ba752        apacherocketmq/rocketmq:4.5.0   "sh mqnamesrv"           40 minutes ago      Up 40 minutes       10909/tcp, 0.0.0.0:9876->9876/tcp, 10911-10912/tcp                         rmqnamesrv
```

浏览器中输入：`http://localhost:8080` 查看控制台

![https://raw.githubusercontent.com/lujiahao0708/PicRepo/master/blogPic/RocketMQ/RocketMQ%E5%9F%BA%E7%A1%80/rocketmq-console-ng.png](https://raw.githubusercontent.com/lujiahao0708/PicRepo/master/blogPic/RocketMQ/RocketMQ基础/rocketmq-console-ng.png)

